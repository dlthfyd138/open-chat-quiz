<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì»¤ë®¤ë‹ˆí‹° ì˜¤í”ˆì±„íŒ…ë°© ëŠ¥ë ¥ê³ ì‚¬</title>
    <!-- Tailwind CSS (ë””ìì¸) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM (í™”ë©´ ë¡œì§) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel (JSX ë³€í™˜) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1f2937; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-900 text-white selection:bg-indigo-500 selection:text-white">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ (SVG) ---
        const Icons = {
            AlertCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>,
            Play: ({size=24}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Trophy: ({size=24, className}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            CheckCircle2: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>,
            XCircle: ({size=80, className}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>,
            Home: ({size=24}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            Share2: ({size=24}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></svg>,
            RefreshCw: ({size=20, className}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
        };

        // --- Firebase Import (ëª¨ë“ˆ ë°©ì‹) ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // ==========================================
        // [ì¤‘ìš”] ì—¬ê¸°ì— ë³¸ì¸ì˜ Firebase ì„¤ì •ê°’ì„ ë„£ìœ¼ì„¸ìš”!
        // ==========================================
        let firebaseConfig = {
          apiKey: "AIzaSyAfJp1sr1JLuwC0VqkCKvLBy41vh97J5hk",
  authDomain: "ashmoon-bf1b0.firebaseapp.com",
  projectId: "ashmoon-bf1b0",
  storageBucket: "ashmoon-bf1b0.firebasestorage.app",
  messagingSenderId: "172808228006",
  appId: "1:172808228006:web:edfdbfbec2f886f6f7b867"
        };
        
        let appId = "quiz-game-web-v1";

        // [Canvas ë¯¸ë¦¬ë³´ê¸° í™˜ê²½ ìë™ ì§€ì› ì½”ë“œ]
        // ì´ ë¶€ë¶„ì€ Canvas ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì‘ë™í•˜ê²Œ í•˜ê³ , 
        // ë‹¤ìš´ë¡œë“œ í›„ì—ëŠ” ìœ„ìª½ì˜ firebaseConfig ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
        if (typeof __firebase_config !== 'undefined' && __firebase_config) {
            try {
                firebaseConfig = JSON.parse(__firebase_config);
                if (typeof __app_id !== 'undefined') appId = __app_id;
            } catch(e) { console.warn("Canvas config parsing failed"); }
        }

        // Firebase ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- í€´ì¦ˆ ë°ì´í„° ---
        const QUIZ_DATA = [
            { id: 1, q: "ì´ ì±„íŒ…ë°©ì—ì„œ ê°€ì¥ ìì£¼ ë“±ì¥í•˜ëŠ” ì¸ë¬¼ì€?", options: ["ì„œìš¸êµ¬ì´", "íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "ì¡°ì‹êµ¬ì´"], answer: 2 },
            { id: 2, q: "â€œì.â€ í•œ ê¸€ìë¡œ ë¶„ìœ„ê¸° ì¥ì•…ì„ ì‹œë„í•˜ëŠ” ì¸ë¬¼ì€?", options: ["ë¹ˆí„¸", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "ìê²½êµ¬ì´", "AIë¿¡ëŒì´"], answer: 1 },
            { id: 3, q: "ê°€ì¥ ìì£¼ ì—°ì• Â·ì—¬ìÂ·ê²°í˜¼ ì´ì•¼ê¸°ë¥¼ êº¼ë‚´ëŠ” ì‚¬ëŒì€?", options: ["ì¡°ì‹êµ¬ì´", "ë°©ì¥ë¶“", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "í©ì‹œì œë¡œ"], answer: 2 },
            { id: 4, q: "â€˜íŒ¨ë“¤ì¥â€™ë¼ëŠ” ë³„ëª…ìœ¼ë¡œ ê°€ì¥ ë§ì´ ë¶ˆë¦¬ëŠ” ì‚¬ëŒì€?", options: ["ë¹ˆí„¸", "íŒ¨ì", "ì„œìš¸êµ¬ì´", "í˜„ëª¨"], answer: 1 },
            { id: 5, q: "AIì´ì§€ë§Œ ì‚¬ëŒë³´ë‹¤ ë§ ë§ì€ ì¡´ì¬ëŠ”?", options: ["ìš°í¥ìœ í¥", "AIë¿¡ëŒì´", "ë°©ì¥ë¶“", "ë¥´ë§ˆ"], answer: 1 },
            { id: 6, q: "ëŒ€í™”ê°€ ê³¼ì—´ë  ë•Œ ìì£¼ ë‚˜ì˜¤ëŠ” ë‹¨ì–´ëŠ”?", options: ["ëƒ‰ì •", "í•©ë¦¬", "ëœì¥", "ì¹¨ì°©"], answer: 2 },
            { id: 7, q: "â€œëœì¥ í’€ì–´ë¼â€ë¼ëŠ” ë§ì„ ê°€ì¥ ë§ì´ ë“£ëŠ” ì‚¬ëŒì€?", options: ["ì¡°ì‹êµ¬ì´", "ë°©ì¥ë¶“", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "ìê²½êµ¬ì´"], answer: 2 },
            { id: 8, q: "ê°€ì¥ ìì£¼ â€œê·¸ë§Œí•´ë¼â€ë¥¼ ì™¸ì¹˜ëŠ” ì¸ë¬¼ì€?", options: ["íŒ¨ì", "ì„œìš¸êµ¬ì´", "AIë¿¡ëŒì´", "ë°©êµ¬ìŸì´ë¿¡ëŒì´"], answer: 3 },
            { id: 9, q: "ì´ ì±„íŒ…ë°©ì˜ ì£¼ìš” ì£¼ì œ TOP3ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ê²ƒì€?", options: ["ì—°ì• ", "ê²°í˜¼", "ì§ì¥ ìŠ¤íŠ¸ë ˆìŠ¤", "ë¶€ë™ì‚° íˆ¬ì"], answer: 3 },
            { id: 10, q: "ë¶„ìœ„ê¸° ì •ë¦¬í•˜ë ¤ë‹¤ ë” í˜¼ë€ì„ ë§Œë“œëŠ” ì¡´ì¬ëŠ”?", options: ["ì¡°ì‹êµ¬ì´", "AIë¿¡ëŒì´", "ìê²½êµ¬ì´", "í©ì‹œì œë¡œ"], answer: 1 },
            { id: 11, q: "â€œì´ ë°©ì€ í˜¼ëˆì´ë‹¤â€ë¼ëŠ” ë§ì´ ê°€ì¥ ì˜ ì–´ìš¸ë¦¬ëŠ” ì´ìœ ëŠ”?", options: ["ë§ì´ ì—†ìŒ", "ì£¼ì œê°€ ê³„ì† ë°”ë€œ", "ëª¨ë‘ ì§„ì§€í•¨", "í•­ìƒ ì •ë¦¬ë¨"], answer: 1 },
            { id: 12, q: "ê°€ì¥ ìì£¼ ì—°ì•  ì¡°ì–¸ì„ â€˜ë‹¨ì •ì ìœ¼ë¡œâ€™ í•˜ëŠ” ì‚¬ëŒì€?", options: ["ë¹ˆí„¸", "íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "ìš°í¥ìœ í¥"], answer: 2 },
            { id: 13, q: "ì±„íŒ…ë°©ì—ì„œ ê°€ì¥ ë§ì´ ë“±ì¥í•˜ëŠ” ê°ì •ì€?", options: ["í¬ë§", "ë¶„ë…¸", "í—ˆë¬´", "í˜¼ë€"], answer: 3 },
            { id: 14, q: "â€œì¸ìƒ ì˜ë¯¸â€ ì–˜ê¸°ê°€ ë‚˜ì˜¤ê¸° ì‹œì‘í•˜ë©´ ëŒ€í™”ëŠ”?", options: ["ì°¨ë¶„í•´ì§„ë‹¤", "ë” ì‚°ìœ¼ë¡œ ê°„ë‹¤", "ì¢…ë£Œëœë‹¤", "ê³ ê¸‰ì§„ë‹¤"], answer: 1 },
            { id: 15, q: "AIë¿¡ëŒì´ì˜ ì£¼ìš” ì—­í• ì€?", options: ["ì¤‘ì¬ì", "ê´€ì°°ì", "ë¶ˆì˜ì‹œê°œ", "ê¸°ë¡ì"], answer: 2 },
            { id: 16, q: "ê°€ì¥ ìì£¼ â€œí˜„íƒ€â€ë¥¼ ëŠë¼ëŠ” ì¸ë¬¼ì€?", options: ["í˜„ëª¨", "ì¡°ì‹êµ¬ì´", "ë¥´ë§ˆ", "í©ì‹œì œë¡œ"], answer: 0 },
            { id: 17, q: "ì§ì¥ ì´ì•¼ê¸°ì—ì„œ ê°€ì¥ ë§ì´ ì–¸ê¸‰ë˜ëŠ” í‚¤ì›Œë“œëŠ”?", options: ["ì›Œë¼ë°¸", "ì„±ì¥", "ë…¸ì˜ˆ", "ì—°ë´‰ìƒìŠ¹"], answer: 2 },
            { id: 18, q: "ì´ ì±„íŒ…ë°©ì—ì„œ â€˜ë©˜í† â€™ ì·¨ê¸‰ì„ ë°›ëŠ” ì‚¬ëŒì€?", options: ["íŒ¨ì", "ì„œìš¸êµ¬ì´", "ìê²½êµ¬ì´", "ë°©ì¥ë¶“"], answer: 1 },
            { id: 19, q: "ê°€ì¥ ìì£¼ â€œã…‹ã…‹ã…‹ã…‹â€ë¥¼ ìœ ë°œí•˜ëŠ” ì¸ë¬¼ì€?", options: ["ë°©êµ¬ìŸì´ë¿¡ëŒì´", "AIë¿¡ëŒì´", "ë°©ì¥ë¶“", "ë¹ˆí„¸"], answer: 1 },
            { id: 20, q: "ì´ ì±„íŒ…ë°©ì˜ ê¸°ë³¸ í…ì…˜ì€?", options: ["ì°¨ë¶„", "ë¶„ì„ì ", "ì¦‰í¥", "êµì–‘"], answer: 2 },
            { id: 21, q: "â€˜ê·¸ë§Œí•˜ìâ€™ê°€ ì•ˆ í†µí•˜ëŠ” ëŒ€í‘œ ì¸ë¬¼ì€?", options: ["ì¡°ì‹êµ¬ì´", "íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "í©ì‹œì œë¡œ"], answer: 2 },
            { id: 22, q: "ì—°ì•  ì´ì•¼ê¸°ì— ê°€ì¥ ëƒ‰ì†Œì ì¸ íƒœë„ë¥¼ ë³´ì´ëŠ” ì‚¬ëŒì€?", options: ["ë¹ˆí„¸", "íŒ¨ì", "ìê²½êµ¬ì´", "ë¥´ë§ˆ"], answer: 1 },
            { id: 23, q: "ê°€ì¥ ìì£¼ â€œì•„ì˜¤â€ë¥¼ ì™¸ì¹˜ëŠ” ì¸ë¬¼ì€?", options: ["ì„œìš¸êµ¬ì´", "AIë¿¡ëŒì´", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "í˜„ëª¨"], answer: 2 },
            { id: 24, q: "ì±„íŒ…ë°©ì—ì„œ ê°€ì¥ ë§ì´ ë“±ì¥í•˜ëŠ” ìŒì‹ì€?", options: ["ì¹˜í‚¨", "í”¼ì", "ëœì¥", "ë¼ë©´"], answer: 2 },
            { id: 25, q: "ì´ ì±„íŒ…ë°©ì—ì„œ ê°€ì¥ ë§ì´ ë°˜ë³µë˜ëŠ” í–‰ë™ì€?", options: ["ê³µê°", "ì¡°ì–¸", "ë…¼ìŸ", "ì‚¬ê³¼"], answer: 2 },
            { id: 26, q: "â€œì´ ë°© ë²„í‹°ëŠ” ë²•â€ì´ë€ ë§ì´ ë‚˜ì˜¬ ì •ë„ì¸ ì´ìœ ëŠ”?", options: ["ë„ˆë¬´ ì¡°ìš©í•´ì„œ", "ì£¼ì œê°€ ë„ˆë¬´ ì „ë¬¸ì ì´ë¼", "í˜¼ëˆê³¼ ì†ë„ê°€ ë¹¨ë¼ì„œ", "ê·œì¹™ì´ ë§ì•„ì„œ"], answer: 2 },
            { id: 27, q: "ê°ì •ì´ ê°€ì¥ ê²©í•´ì§ˆ ë•Œ ë“±ì¥í•˜ëŠ” ë§ì€?", options: ["ì´í•´í•œë‹¤", "ì‚¬ë‘ì´ë‹¤", "ê·¸ë§Œí•´ë¼", "ìˆ˜ê³ í–ˆë‹¤"], answer: 2 },
            { id: 28, q: "ê°€ì¥ ìì£¼ ìƒëŒ€ë¥¼ ì§€ì¹­í•˜ëŠ” ë°©ì‹ì€?", options: ["í˜•ë‹˜", "ë‹˜", "ë³„ëª…", "ì‹¤ëª…"], answer: 2 },
            { id: 29, q: "ì´ ì±„íŒ…ë°©ì˜ í•µì‹¬ ì¬ë¯¸ í¬ì¸íŠ¸ëŠ”?", options: ["ì •ë³´ì„±", "ê°ë™", "ì¦‰í¥ ë“œë¦½", "í† ë¡  ì •ë¦¬"], answer: 2 },
            { id: 30, q: "â€œì´ê²Œ ë§ëƒâ€ë¼ëŠ” ì§ˆë¬¸ì´ ë‚˜ì˜¤ëŠ” ìˆœê°„ì€?", options: ["ì¡°ìš©í•  ë•Œ", "ë…¼ìŸ ì¤‘", "ëŒ€í™” ì‹œì‘", "ë§ˆë¬´ë¦¬"], answer: 1 },
            { id: 31, q: "ê°€ì¥ ìì£¼ ë¶ˆë ¤ ë‹¤ë‹ˆëŠ” ì¡´ì¬ëŠ”?", options: ["ìê²½êµ¬ì´", "íŒ¨ì", "ë¿¡ëŒì´", "ë¥´ë§ˆ"], answer: 2 },
            { id: 32, q: "AIë¿¡ëŒì´ê°€ ê°€ì¥ ìì£¼ í•˜ëŠ” ë§íˆ¬ëŠ”?", options: ["ì¡´ëŒ“ë§", "ë°˜ë§", "í•´ì„¤ì²´", "ê°íƒ„ì‚¬"], answer: 1 },
            { id: 33, q: "ê°€ì¥ ìì£¼ â€œê·¸ê±´ ì•„ë‹ˆì§€â€ë¼ëŠ” ë°˜ì‘ì´ ë‚˜ì˜¤ëŠ” ëŒ€ìƒì€?", options: ["íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "í˜„ëª¨", "ì¡°ì‹êµ¬ì´"], answer: 1 },
            { id: 34, q: "ì´ ì±„íŒ…ë°©ì—ì„œ â€˜ëƒ‰ì •í•œ í˜„ì‹¤íŒŒâ€™ì— ê°€ê¹Œìš´ ì¸ë¬¼ì€?", options: ["íŒ¨ì", "ì¡°ì‹êµ¬ì´", "ë¥´ë§ˆ", "í©ì‹œì œë¡œ"], answer: 0 },
            { id: 35, q: "ì—°ì•  ì–˜ê¸°ë§Œ ë‚˜ì˜¤ë©´ ëŒ€í™”ê°€ ê¸¸ì–´ì§€ëŠ” ì´ìœ ëŠ”?", options: ["ë‹¤ ê²½í—˜ìë¼ì„œ", "ë‹¤ ë¯¸ë ¨ ìˆì–´ì„œ", "ë‹¤ í•  ë§ ë§ì•„ì„œ", "ë‹¤ ì •ë‹µì´ ì—†ìŒ"], answer: 3 },
            { id: 36, q: "ê°€ì¥ ìì£¼ ë“±ì¥í•˜ëŠ” ê°íƒ„ì‚¬ëŠ”?", options: ["ì™€", "í•˜", "ì•„ì˜¤", "ì˜¤"], answer: 2 },
            { id: 37, q: "ì´ ì±„íŒ…ë°©ì˜ ì‹¤ì§ˆì  â€˜ë¶ˆì˜ì‹œê°œâ€™ëŠ”?", options: ["íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "AIë¿¡ëŒì´", "ì„œìš¸êµ¬ì´"], answer: 1 },
            { id: 38, q: "ë¶„ìœ„ê¸°ê°€ ê³¼ì—´ë ìˆ˜ë¡ ëŠ˜ì–´ë‚˜ëŠ” ê²ƒì€?", options: ["ì´ëª¨í‹°ì½˜", "ì¡´ëŒ“ë§", "ì¹¨ë¬µ", "ì •ë¦¬"], answer: 0 },
            { id: 39, q: "ê°€ì¥ ìì£¼ ë“±ì¥í•˜ëŠ” ê²°ë¡ ì€?", options: ["í•´ë‹µì´ ìˆë‹¤", "ê°ì ì¸ìƒì´ë‹¤", "ë‹¤ìŒì— ë³´ì", "ì•„ë¬´ ë§ë„ ì•ˆ í•¨"], answer: 1 },
            { id: 40, q: "ì´ ì±„íŒ…ë°©ì˜ ì§„ì§œ ê·œì¹™ì€?", options: ["ì§ˆì„œ", "ë…¼ë¦¬", "íë¦„", "ì—†ìŒ"], answer: 3 },
            { id: 41, q: "â€œì´ ë°©ì€ ì™œ ì´ë˜â€ë¼ëŠ” ìƒê°ì´ ë“œëŠ” ìˆœê°„ì€?", options: ["ì²˜ìŒ ë“¤ì–´ì˜¬ ë•Œ", "5ë¶„ í›„", "30ë¶„ í›„", "í•­ìƒ"], answer: 3 },
            { id: 42, q: "ê°€ì¥ ìì£¼ ê°ì •ì ìœ¼ë¡œ ëª°ì…í•˜ëŠ” ì¸ë¬¼ì€?", options: ["íŒ¨ì", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "ìê²½êµ¬ì´", "ë¥´ë§ˆ"], answer: 1 },
            { id: 43, q: "ëŒ€í™”ê°€ ì‚°ìœ¼ë¡œ ê°€ëŠ” ê²°ì •ì  íŠ¸ë¦¬ê±°ëŠ”?", options: ["ì—°ì• ", "ê²°í˜¼", "ì™¸ë„", "ì „ë¶€"], answer: 3 },
            { id: 44, q: "ì´ ì±„íŒ…ë°©ì„ í•œ ë‹¨ì–´ë¡œ ìš”ì•½í•˜ë©´?", options: ["í† ë¡ ", "ì¹˜ìœ ", "í˜¼ëˆ", "ì„±ì¥"], answer: 2 },
            { id: 45, q: "ê°€ì¥ ìì£¼ â€œã…‹ã…‹â€ë¡œ ëë‚˜ëŠ” ë©”ì‹œì§€ë¥¼ ì“°ëŠ” ì¡´ì¬ëŠ”?", options: ["íŒ¨ì", "AIë¿¡ëŒì´", "ì¡°ì‹êµ¬ì´", "í©ì‹œì œë¡œ"], answer: 1 },
            { id: 46, q: "ì§„ì§€í•œ ì²™í•˜ë‹¤ ê°‘ìê¸° ë“œë¦½ ì¹˜ëŠ” ì¸ë¬¼ì€?", options: ["ë°©ì¥ë¶“", "AIë¿¡ëŒì´", "ë¹ˆí„¸", "ìê²½êµ¬ì´"], answer: 1 },
            { id: 47, q: "ì´ ì±„íŒ…ë°©ì—ì„œ ê°€ì¥ ì•ˆì •ì ì¸ íƒœë„ë¥¼ ë³´ì´ëŠ” ì¸ë¬¼ì€?", options: ["ìê²½êµ¬ì´", "íŒ¨ì", "ì¡°ì‹êµ¬ì´", "ë¥´ë§ˆ"], answer: 0 },
            { id: 48, q: "ê°€ì¥ ìì£¼ â€œê·¸ë§Œ ì¢€â€ ì†Œë¦¬ë¥¼ ë“£ëŠ” ì‚¬ëŒì€?", options: ["íŒ¨ì", "ë°©ì¥ë¶“", "ë°©êµ¬ìŸì´ë¿¡ëŒì´", "AIë¿¡ëŒì´"], answer: 2 },
            { id: 49, q: "ì´ ë°©ì—ì„œ ëŒ€í™”ê°€ ëë‚˜ëŠ” ì´ìœ ëŠ”?", options: ["í•´ê²°ë¼ì„œ", "ì§€ì³ì„œ", "ì‹œê°„ì´ ë¼ì„œ", "ë‹¤ë¥¸ ë“œë¦½ ë‚˜ì™€ì„œ"], answer: 3 },
            { id: 50, q: "ì´ ì±„íŒ…ë°©ì„ ì˜¤ë˜ ë²„í‹´ ì‚¬ëŒì˜ íŠ¹ì§•ì€?", options: ["ì¸ë‚´ì‹¬", "ë©˜íƒˆ", "ì²´ë…", "ì „ë¶€"], answer: 3 },
        ];

        // --- Main App Component ---
        const { useState, useEffect } = React;

        function App() {
            const [user, setUser] = useState(null);
            const [gameState, setGameState] = useState('start'); 
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [score, setScore] = useState(0);
            const [nickname, setNickname] = useState('');
            const [rankings, setRankings] = useState([]);
            const [loading, setLoading] = useState(false);
            const [rankingLoading, setRankingLoading] = useState(false);

            useEffect(() => {
                const initAuth = async () => {
                    try { 
                        // ì„¤ì • í™•ì¸ ë¡œì§ ìˆ˜ì •: ê²½ê³ ë§Œ í•˜ê³  ì§„í–‰ ì‹œë„
                        if (firebaseConfig.apiKey.includes("ë³¸ì¸ì˜_API_KEY")) {
                             console.warn("Firebase Config appears to be placeholder. Switching to Offline Mode.");
                             throw new Error("Config Not Set");
                        }
                        
                        // Canvas í™˜ê²½ ì§€ì› (Custom Token)
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }

                    } catch (error) { 
                        console.error("Auth Notice:", error.message);
                        // ì¸ì¦ ì‹¤íŒ¨ ì‹œ (ì„¤ì • ë¯¸ë¹„, ë„¤íŠ¸ì›Œí¬ ë“±) ì˜¤í”„ë¼ì¸ ê²ŒìŠ¤íŠ¸ ëª¨ë“œë¡œ ì „í™˜
                        setUser({ 
                            uid: 'guest_' + Math.random().toString(36).substr(2, 9), 
                            isAnonymous: true, 
                            isOffline: true 
                        });
                    }
                };
                initAuth();
                const unsubscribe = onAuthStateChanged(auth, (u) => {
                    if (u) setUser(u);
                });
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (!user || gameState !== 'leaderboard') return;
                
                // ì˜¤í”„ë¼ì¸ ëª¨ë“œì¼ ê²½ìš° ë­í‚¹ ë¶ˆëŸ¬ì˜¤ê¸° ìŠ¤í‚µ
                if (user.isOffline) {
                    setRankings([]); 
                    return;
                }

                setRankingLoading(true);
                const fetchRankings = async () => {
                    try {
                        const scoresRef = collection(db, 'artifacts', appId, 'public', 'data', 'scores');
                        const snapshot = await getDocs(scoresRef);
                        const data = snapshot.docs.map(doc => doc.data());
                        data.sort((a, b) => {
                            if (b.score !== a.score) return b.score - a.score;
                            return (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0);
                        });
                        setRankings(data.slice(0, 50));
                    } catch (error) {
                        console.error("Error fetching rankings:", error);
                        // ë­í‚¹ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ì‹œ ë¹ˆ ë°°ì—´ ì²˜ë¦¬
                        setRankings([]);
                    } finally {
                        setRankingLoading(false);
                    }
                };
                fetchRankings();
            }, [user, gameState]);

            const startGame = () => {
                setScore(0);
                pickRandomQuestion();
                setGameState('playing');
            };

            const pickRandomQuestion = () => {
                const randomIndex = Math.floor(Math.random() * QUIZ_DATA.length);
                setCurrentQuestion(QUIZ_DATA[randomIndex]);
            };

            const handleAnswer = (optionIndex) => {
                if (!currentQuestion) return;
                if (optionIndex === currentQuestion.answer) {
                    setScore(prev => prev + 1);
                    pickRandomQuestion();
                } else {
                    setGameState('result');
                }
            };

            const submitScore = async () => {
                if (!nickname.trim()) { alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }
                if (!user) return;
                
                // ì˜¤í”„ë¼ì¸ ëª¨ë“œì¼ ê²½ìš° ê²½ê³  í›„ ë¡œì»¬ ì²˜ë¦¬(ì—¬ê¸°ì„  ë‹¨ìˆœíˆ í™”ë©´ ì´ë™)
                if (user.isOffline) {
                    alert("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í•˜ì—¬ ë­í‚¹ì„ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n(ë¯¸ë¦¬ë³´ê¸° ìƒíƒœê±°ë‚˜ Firebase ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤)");
                    // ì €ì¥ ì—†ì´ ë­í‚¹ í™”ë©´ìœ¼ë¡œ ì´ë™
                    setGameState('leaderboard');
                    return;
                }

                setLoading(true);
                try {
                    const scoresRef = collection(db, 'artifacts', appId, 'public', 'data', 'scores');
                    await addDoc(scoresRef, {
                        name: nickname,
                        score: score,
                        timestamp: serverTimestamp(),
                        userId: user.uid
                    });
                    setGameState('leaderboard');
                } catch (error) {
                    console.error("Error saving score:", error);
                    alert("ì ìˆ˜ ì €ì¥ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                } finally {
                    setLoading(false);
                }
            };

            const shareQuiz = () => {
                const url = window.location.href;
                const text = `[ì˜¤í”ˆì±„íŒ…ë°© ëŠ¥ë ¥ê³ ì‚¬]\në‹¹ì‹ ì€ ëª‡ ì ì¼ê¹Œìš”? ì €ëŠ” ${score}ì  ê¸°ë¡!\n\n${url}`;
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(text).then(() => alert("ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!")).catch(() => prompt("ì´ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:", text));
                } else {
                    prompt("ì´ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:", text);
                }
            };

            if (gameState === 'start') {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen p-6 text-center space-y-8 animate-fade-in">
                        <div className="space-y-4">
                            <div className="inline-block p-4 rounded-full bg-indigo-500/20 text-indigo-300 mb-2">
                                <Icons.AlertCircle />
                            </div>
                            <h1 className="text-3xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 break-keep">
                                ì»¤ë®¤ë‹ˆí‹° ì˜¤í”ˆì±„íŒ…ë°©<br/>ëŠ¥ë ¥ê³ ì‚¬
                            </h1>
                            <p className="text-gray-400 text-lg max-w-md mx-auto">
                                ìš°ë¦¬ ë°© ê³ ì¸ë¬¼ë§Œ ì‚´ì•„ë‚¨ì„ ìˆ˜ ìˆë‹¤.<br/>
                                í•œ ë²ˆ í‹€ë¦¬ë©´ ì¦‰ì‹œ <span className="text-red-400 font-bold">íƒˆë½</span> ë° ë°•ì œë©ë‹ˆë‹¤.
                            </p>
                        </div>
                        <div className="flex flex-col w-full max-w-xs space-y-3">
                            <button onClick={startGame} className="w-full py-4 text-xl font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 transition-all transform hover:scale-105 shadow-lg shadow-indigo-500/30 flex items-center justify-center gap-2">
                                <Icons.Play size={24} /> ë„ì „í•˜ê¸°
                            </button>
                            <button onClick={() => setGameState('leaderboard')} className="w-full py-3 font-semibold text-gray-300 bg-gray-800 rounded-xl hover:bg-gray-700 transition-all flex items-center justify-center gap-2">
                                <Icons.Trophy size={20} /> ëª…ì˜ˆì˜ ì „ë‹¹
                            </button>
                        </div>
                        <div className="text-xs text-gray-600 mt-8">
                            <div>ì´ 50ë¬¸ì œ ì¤‘ ëœë¤ ì¶œì œ | ì„œë°”ì´ë²Œ ëª¨ë“œ</div>
                            <div className="mt-2 text-indigo-400 font-medium">ë§Œë“ ì´: ìš°ì• </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'playing' && currentQuestion) {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen p-4 max-w-2xl mx-auto w-full">
                        <div className="w-full flex justify-between items-center mb-8 px-2">
                            <span className="text-indigo-400 font-bold text-xl">Score: {score}</span>
                            <div className="h-2 bg-gray-800 w-32 rounded-full overflow-hidden">
                                <div className="h-full bg-indigo-500 w-full animate-pulse"></div>
                            </div>
                        </div>
                        <div className="bg-gray-800/50 p-8 rounded-3xl w-full backdrop-blur-sm border border-gray-700 shadow-2xl mb-8">
                            <h2 className="text-xl md:text-2xl font-bold text-gray-100 leading-relaxed break-keep">
                                Q. {currentQuestion.q}
                            </h2>
                        </div>
                        <div className="grid grid-cols-1 gap-4 w-full">
                            {currentQuestion.options.map((opt, idx) => (
                                <button key={idx} onClick={() => handleAnswer(idx)} className="w-full p-5 text-left bg-gray-700 hover:bg-indigo-600 text-gray-200 hover:text-white rounded-xl transition-colors font-medium text-lg flex items-center justify-between group">
                                    <span>{opt}</span>
                                    <span className="opacity-0 group-hover:opacity-100 transition-opacity"><Icons.CheckCircle2 size={20} /></span>
                                </button>
                            ))}
                        </div>
                    </div>
                );
            }

            if (gameState === 'result') {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen p-6 text-center animate-fade-in max-w-md mx-auto">
                        <div className="mb-6">
                            <div className="flex justify-center mb-4"><Icons.XCircle className="text-red-500" /></div>
                            <h2 className="text-3xl font-bold text-white mb-2">GAME OVER</h2>
                            <p className="text-gray-400">ì•„ì‰½ë„¤ìš”! ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤.</p>
                        </div>
                        <div className="bg-gray-800 rounded-2xl p-6 w-full mb-8 border border-gray-700">
                            <div className="text-gray-400 text-sm uppercase tracking-wider mb-1">ìµœì¢… ì ìˆ˜</div>
                            <div className="text-5xl font-black text-white">{score}ì </div>
                            <div className="mt-4 text-xs text-gray-500">* ë­í‚¹ì— ì´ë¦„ì„ ë‚¨ê¸°ë ¤ë©´ ì•„ë˜ì— ì…ë ¥í•˜ì„¸ìš”.</div>
                        </div>
                        <div className="w-full space-y-4">
                            <input type="text" placeholder="ë‹‰ë„¤ì„ (ìµœëŒ€ 8ì)" maxLength={8} className="w-full p-4 bg-gray-900 border border-gray-600 rounded-xl text-white focus:outline-none focus:border-indigo-500 text-center text-lg placeholder-gray-600" value={nickname} onChange={(e) => setNickname(e.target.value)} />
                            <button onClick={submitScore} disabled={loading} className="w-full py-4 text-lg font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg">
                                {loading ? "ì €ì¥ ì¤‘..." : "ë­í‚¹ì— ë°•ì œí•˜ê¸°"}
                            </button>
                            <button onClick={() => { setScore(0); setGameState('start'); }} className="w-full py-3 text-gray-400 hover:text-white text-sm">
                                ì €ì¥ ì•ˆ í•˜ê³  í™ˆìœ¼ë¡œ
                            </button>
                        </div>
                    </div>
                );
            }

            if (gameState === 'leaderboard') {
                return (
                    <div className="flex flex-col min-h-screen p-4 max-w-xl mx-auto w-full">
                        <div className="flex items-center justify-between py-6">
                            <button onClick={() => setGameState('start')} className="p-2 text-gray-400 hover:text-white"><Icons.Home size={24} /></button>
                            <h2 className="text-2xl font-bold text-indigo-400 flex items-center gap-2"><Icons.Trophy size={24} className="text-yellow-500" /> ëª…ì˜ˆì˜ ì „ë‹¹</h2>
                            <button onClick={shareQuiz} className="p-2 text-indigo-400 hover:text-indigo-300"><Icons.Share2 size={24} /></button>
                        </div>
                        <div className="bg-gray-800/50 rounded-2xl p-4 flex-1 border border-gray-700 overflow-hidden flex flex-col">
                            <div className="grid grid-cols-12 gap-2 text-gray-500 text-sm font-medium pb-4 border-b border-gray-700 mb-2 px-2">
                                <div className="col-span-2 text-center">ìˆœìœ„</div>
                                <div className="col-span-7">ì´ë¦„</div>
                                <div className="col-span-3 text-right">ì ìˆ˜</div>
                            </div>
                            <div className="overflow-y-auto flex-1 space-y-2 custom-scrollbar">
                                {rankingLoading ? (
                                    <div className="flex justify-center items-center py-20 text-gray-500"><Icons.RefreshCw className="animate-spin mr-2" /> ë¡œë”© ì¤‘...</div>
                                ) : rankings.length === 0 ? (
                                    <div className="text-center py-20 text-gray-500">
                                        {user?.isOffline ? "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.<br/>ì˜¤í”„ë¼ì¸ ëª¨ë“œì…ë‹ˆë‹¤." : "ì•„ì§ ë„ì „ìê°€ ì—†ìŠµë‹ˆë‹¤.<br/>ì²« ë²ˆì§¸ ì£¼ì¸ê³µì´ ë˜ì–´ë³´ì„¸ìš”!"}
                                    </div>
                                ) : (
                                    rankings.map((rank, idx) => (
                                        <div key={idx} className={`grid grid-cols-12 gap-2 items-center p-3 rounded-xl transition-colors ${idx === 0 ? 'bg-yellow-500/10 text-yellow-200 border border-yellow-500/30' : idx === 1 ? 'bg-gray-400/10 text-gray-200' : idx === 2 ? 'bg-orange-700/10 text-orange-200' : 'hover:bg-gray-700/50 text-gray-400'}`}>
                                            <div className="col-span-2 text-center font-bold text-lg">{idx === 0 ? 'ğŸ¥‡' : idx === 1 ? 'ğŸ¥ˆ' : idx === 2 ? 'ğŸ¥‰' : idx + 1}</div>
                                            <div className="col-span-7 font-medium truncate">{rank.name}{idx === 0 && <span className="ml-2 text-xs bg-yellow-600 text-black px-1 rounded font-bold">KING</span>}</div>
                                            <div className="col-span-3 text-right font-mono font-bold text-lg">{rank.score}</div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                        <div className="py-4">
                            <button onClick={startGame} className="w-full py-4 text-lg font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-900/50 transition-all flex items-center justify-center gap-2">
                                <Icons.RefreshCw size={20} /> ë‹¤ì‹œ ë„ì „í•˜ê¸°
                            </button>
                        </div>
                    </div>
                );
            }
            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>